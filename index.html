<!DOCTYPE html>
<html lang="en">
<head>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5F2MS464');</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Dynamic Fractal Cosmological Model (DFCM)</title>

    <meta name="description" content="Discover the Dynamic Fractal Cosmological Model (DFCM), a new paradigm that resolves major tensions in modern cosmology, including the Hubble tension and Lithium-7 problem, and offers a 7.1σ statistical improvement over ΛCDM.">
    <meta name="keywords" content="cosmology, fractal, cosmological model, DFCM, Hubble tension, Lithium-7 problem, dark matter, dark energy, Friedmann equations, ΛCDM, Big Bang Nucleosynthesis, cosmic acceleration, galaxy clustering, redshift, BBN, Planck, DESI, SNIa, Pantheon+, cosmic chronometers, CMB, matter power spectrum">
    <meta name="author" content="Sylvain Herbin">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://phi-z.space/">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://phi-z.space/">
    <meta property="og:title" content="The Dynamic Fractal Cosmological Model (DFCM) - A New Paradigm in Cosmology">
    <meta property="og:description" content="Discover DFCM, a groundbreaking cosmological model that introduces an evolving spacetime dimension φ(z) to naturally resolve the Hubble tension, Lithium-7 problem, and large-scale structure tensions, achieving a 7.1σ improvement over ΛCDM.">
    <meta property="og:image" content="https://phi-z.space/images/dfcm-og-image.jpg">
    <meta property="og:image:alt" content="Conceptual image representing the evolving spacetime dimension in DFCM">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://phi-z.space/">
    <meta name="twitter:title" content="The Dynamic Fractal Cosmological Model (DFCM)">
    <meta name="twitter:description" content="DFCM: A new cosmological model resolving the Hubble and Lithium-7 tensions, achieving a 7.1σ statistical improvement over ΛCDM with an evolving spacetime dimension.">
    <meta name="twitter:image" content="https://phi-z.space/images/dfcm-twitter-image.jpg">
    <meta name="twitter:creator" content="@YourTwitterHandle">
    <meta name="twitter:site" content="@YourTwitterHandle">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="style.css">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5F2MS464"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <div class="stars" id="stars"></div>

    <div class="container">
        <header>
            <a href="#" class="logo" onclick="showPage('home')">
                <span class="logo-symbol">φ(z)</span>
                <span>.space</span>
            </a>
            <nav>
                <ul>
                    <li><a href="#" class="active" onclick="showPage('home')">Home</a></li>
                    <li><a href="#" onclick="showPage('tensions')">Tensions Solved</a></li>
                    <li><a href="#" onclick="showPage('predictions')">Predictions</a></li>
                    <li><a href="#" onclick="showPage('glossary')">Glossary</a></li>
                    <li><a href="#" onclick="showPage('ai_assistant')">AI Assistant</a></li>
                </ul>
            </nav>
        </header>

        <div id="home" class="page active">
            <section class="hero">
                <h1>The Dynamic Fractal Cosmological Model</h1>
                <p>Discover a new paradigm that resolves the greatest tensions in modern cosmology. By introducing an evolving spacetime dimension, DFCM accurately predicts the Universe's expansion, the formation of cosmic structures, and achieves a <strong>7.1σ statistical improvement</strong> over the standard ΛCDM model.</p>
                <a href="https://doi.org/10.5281/zenodo.15973540" target="_blank" class="btn btn-download">
                    <i class="fas fa-rocket"></i>
                    <span>Explore the Full Paper</span>
                    <span class="btn-glow"></span>
                </a>
            </section>

            <section class="model-section">
                <h2 class="section-title">Fundamental Principles</h2>
                <div class="model-grid">
                    <div class="model-card">
                        <i class="fas fa-wave-square"></i>
                        <h3>Evolving Spacetime Dimension φ(z)</h3>
                        <p>The model's core is the dynamic fractal dimension of spacetime, φ(z). It evolves with redshift from a primordial value (φ<sub>BBN</sub>=2.970) to a present-day value near the golden ratio (φ<sub>∞</sub>=1.618), governing all cosmic dynamics.</p>
                    </div>

                    <div class="model-card">
                        <i class="fas fa-rocket"></i>
                        <h3>Modified Cosmic Dynamics</h3>
                        <p>This evolving dimension is embedded in the Friedmann equations, altering the Universe's expansion history. This naturally explains cosmic acceleration without a separate dark energy component and provides a superior fit to observational data.</p>
                    </div>

                    <div class="model-card">
                        <i class="fas fa-atom"></i>
                        <h3>Novel Dark Matter-Baryon Coupling</h3>
                        <p>DFCM introduces a new coupling between dark matter and baryons, governed by φ(z). This interaction modifies the growth of large-scale structures, precisely explaining the observed galaxy distribution and the deficit of massive galaxy clusters.</p>
                    </div>
                </div>
            </section>

            <section class="model-section">
                <h2 class="section-title">Physical Insights of DFCM</h2>
                <p style="text-align: center; max-width: 800px; margin: 0 auto; color: var(--text-secondary);">
                    The Dynamic Fractal Cosmological Model (DFCM) redefines our understanding of the Universe by introducing a spacetime that evolves in complexity. The fractal dimension φ(z) transitions from a primordial value of 2.970 during the Big Bang Nucleosynthesis (BBN) era to the golden ratio (1.618) in the present day. This evolution naturally explains cosmic acceleration, resolves the Hubble tension, and aligns with observations of galaxy clustering without requiring exotic dark energy.
                </p>
                <div class="model-grid">
                    <div class="model-card">
                        <i class="fas fa-star"></i>
                        <h3>Fractal Transition</h3>
                        <p>The shift in φ(z) reflects a cosmic phase transition, akin to water freezing into ice, where spacetime's geometry adapts to the Universe's expansion. This is driven by a scalar field that emerges from fractal metric fluctuations.</p>
                    </div>
                    <div class="model-card">
                        <i class="fas fa-globe"></i>
                        <h3>Unified Dynamics</h3>
                        <p>By embedding φ(z) in the Friedmann equations, DFCM unifies the expansion history and structure formation, offering a single framework to explain both early and late Universe phenomena.</p>
                    </div>
                </div>
            </section>

            <section class="model-section">
                <h2 class="section-title">The Central Equation</h2>
                <p style="text-align: center; max-width: 800px; margin: 0 auto; color: var(--text-secondary);">
                    The expansion of the Universe in DFCM is described by a modified Friedmann equation where the exponents depend on the dynamic fractal dimension φ(z).
                </p>
                <div class="equation-box">
                    $$ H^2(z) = H_0^2\left[\Omega_m(1+z)^{3\phi(z)} + \Omega_\Lambda(1+z)^{3(2-\phi(z))}\right] $$
                </div>
            </section>

            <section class="model-section">
                <h2 class="section-title">Goodness-of-Fit Results</h2>
                <p style="text-align: center; max-width: 800px; margin: 0 auto 40px; color: var(--text-secondary);">
                    The Dynamic Fractal Cosmological Model demonstrates exceptional agreement with observational data across multiple cosmological probes. The table below summarizes the $\chi^2/\text{dof}$ values, showcasing a remarkable 7.1σ improvement over the standard ΛCDM model.
                </p>
                <div class="futuristic-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Cosmological Probe</th>
                                <th>Chi-squared/dof</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Pantheon+ SNIa</td>
                                <td>0.613</td>
                                <td>Exceptional fit to Type Ia Supernovae, confirming the model's accuracy in predicting luminosity distances.</td>
                            </tr>
                            <tr>
                                <td>BAO (DESI EDR)</td>
                                <td>0.939</td>
                                <td>Accurate fit to Baryon Acoustic Oscillations, aligning with DESI data and resolving sound horizon discrepancies.</td>
                            </tr>
                            <tr>
                                <td>Cosmic Chronometers</td>
                                <td>0.997</td>
                                <td>Robust fit to Hubble parameter measurements, supporting the modified expansion history.</td>
                            </tr>
                            <tr>
                                <td>CMB (Planck)</td>
                                <td>1.475</td>
                                <td>Addresses low-ℓ anomalies in the CMB power spectrum with a power suppression of S=0.93±0.02.</td>
                            </tr>
                            <tr>
                                <td>Galaxy 2PCF</td>
                                <td>0.717</td>
                                <td>Precise match to galaxy correlation functions, capturing redshift-dependent structure growth.</td>
                            </tr>
                            <tr>
                                <td>Cluster Mass Function</td>
                                <td>1.228</td>
                                <td>Resolves the deficit of massive galaxy clusters at z ~ 0.6, predicting a 18.2% ± 2.3% reduction.</td>
                            </tr>
                            <tr>
                                <td>Combined (Selected Probes)</td>
                                <td>0.951</td>
                                <td>Overall fit across BAO, CMB, 2PCF, and clusters, achieving a 7.1σ improvement over ΛCDM.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section class="model-section">
                <h2 class="section-title">Interactive Visualizations</h2>
                <p style="text-align: center; max-width: 800px; margin: 0 auto 40px; color: var(--text-secondary);">
                    Explore the evolution of the fractal dimension φ(z) across cosmic time, from the Big Bang to the present day.
                </p>
                
                <div class="cosmic-timeline-container">
                    <div class="visualization-container">
                        <canvas id="cosmicCanvas" class="cosmic-canvas"></canvas>
                        <div class="info-panel">
                            <div class="phi-value">φ(z) = 2.970</div>
                            <div class="epoch-description">Dense fractal primordial universe</div>
                        </div>
                    </div>
                    
                    <div class="timeline-container">
                        <div class="timeline">
                            <div class="timeline-progress" id="timelineProgress"></div>
                            <input type="range" min="0" max="100" value="0" class="timeline-slider" id="timeSlider">
                        </div>
                        
                        <div class="epoch-markers">
                            <div class="epoch">
                                <div class="epoch-title">BBN</div>
                                <div class="epoch-time">z ≈ 10⁹</div>
                            </div>
                            <div class="epoch">
                                <div class="epoch-title">CMB</div>
                                <div class="epoch-time">z ≈ 1100</div>
                            </div>
                            <div class="epoch">
                                <div class="epoch-title">Galaxy Formation</div>
                                <div class="epoch-time">z ≈ 10</div>
                            </div>
                            <div class="epoch">
                                <div class="epoch-title">Present Era</div>
                                <div class="epoch-time">z = 0</div>
                            </div>
                        </div>
                        
                        <div class="controls">
                            <button class="control-btn" id="playBtn">▶ Play</button>
                            <button class="control-btn" id="pauseBtn">⏸ Pause</button>
                            <button class="control-btn" id="resetBtn">↺ Reset</button>
                        </div>
                    </div>
                </div>
            </section>
        </div>
<div id="tensions" class="page">
            <section class="hero">
                <h1>Resolving Key Cosmological Tensions</h1>
                <p>The standard model of cosmology (ΛCDM) faces several critical challenges. DFCM offers natural and precise solutions.</p>
            </section>

            <section class="model-section">
                <div class="model-grid">
                    <div class="model-card">
                        <i class="fas fa-ruler-combined"></i>
                        <h3>The Hubble Constant (H<sub>0</sub>) Tension</h3>
                        <p><strong>Problem:</strong> The expansion rate measured locally (fast) disagrees with the rate inferred from the early Universe (slow).</p>
                        <p><strong>DFCM Solution:</strong> The modified expansion history naturally bridges the gap. It predicts H<sub>0</sub> = 73.24 ± 0.42 km/s/Mpc, aligning with local SH0ES measurements at an unprecedented <strong>0.3σ</strong> level.</p>
                    </div>
                    <div class="model-card">
                        <i class="fas fa-atom"></i>
                        <h3>The Lithium-7 Problem</h3>
                        <p><strong>Problem:</strong> ΛCDM predicts 3-4 times more primordial Lithium-7 than is observed in ancient stars.</p>
                        <p><strong>DFCM Solution:</strong> By setting a specific primordial fractal dimension (φ<sub>BBN</sub> = 2.970), the model alters nuclear reaction rates during BBN, bringing the predicted Lithium-7 abundance into <strong>1.8σ agreement</strong> with observations.</p>
                    </div>
                    <div class="model-card">
                        <i class="fas fa-galaxy"></i>
                        <h3>Large-Scale Structure (LSS) Tensions</h3>
                        <p><strong>Problem:</strong> ΛCDM predicts more massive galaxy clusters than are observed and struggles with the precise galaxy distribution.</p>
                        <p><strong>DFCM Solution:</strong> The new dark matter-baryon coupling suppresses the formation of the most massive structures, predicting a cluster deficit of <strong>18.2% ± 2.3%</strong> at z ~ 0.6 and providing a superior fit to data.</p>
                    </div>
                </div>
            </section>
        </div>

        <div id="predictions" class="page">
            <section class="hero">
                <h1>Testable Predictions for Future Surveys</h1>
                <p>A robust model makes falsifiable predictions. DFCM offers distinct signatures that will be tested by the next generation of astronomical instruments.</p>
            </section>

            <section class="model-section">
                <h2 class="section-title">Matter Power Spectrum Deviations</h2>
                <p style="text-align: center; max-width: 800px; margin: 0 auto 40px; color: var(--text-secondary);">
                    DFCM predicts specific deviations in the clustering of matter compared to ΛCDM, which will be visible in upcoming galaxy surveys.
                </p>
                <div class="model-card">
                    <h3>Predicted Deviations</h3>
                    <ul>
                        <li><strong>Euclid (spectro):</strong> +8.2% ± 0.9%</li>
                        <li><strong>Roman HLS:</strong> +12.7% ± 1.2%</li>
                        <li><strong>DESI-II:</strong> +18.3% ± 2.1%</li>
                    </ul>
                </div>
            </section>

            <section class="model-section">
                <h2 class="section-title">CMB Spectral µ-Distortions</h2>
                <p style="text-align: center; max-width: 800px; margin: 0 auto 40px; color: var(--text-secondary);">
                    The cosmic phase transition in DFCM should leave a faint but detectable imprint on the CMB's blackbody spectrum.
                </p>
                <div class="model-card">
                    <h3>Predicted µ-Distortion Amplitude</h3>
                    <p>The model predicts a signal of:</p>
                    <div class="equation-box" style="font-size: 1.2rem; padding: 20px;">
                        $$ \mu = (1.7 \pm 0.3) \times 10^{-8} $$
                    </div>
                    <p>This is detectable by a future mission like PIXIE, providing a definitive test of the model's early-universe physics.</p>
                </div>
            </section>
        </div>

        <div id="glossary" class="page">
            <section class="hero">
                <h1>Glossary</h1>
                <p>Understanding the cosmos requires a special vocabulary. Here are simple definitions for key terms used in this website, expanded to cover the DFCM model in detail.</p>
            </section>
            <dl class="glossary-list">
                <dt>Redshift (z)</dt>
                <dd>A measure of how much the light from a distant object has been stretched (shifted towards redder wavelengths) by the expansion of the Universe. A higher redshift means an object is farther away and its light was emitted longer ago, so we see it as it was in the past.</dd>
                <dt>Hubble Constant (H<sub>0</sub>)</dt>
                <dd>The current rate at which the Universe is expanding. Its precise value is a major point of contention in modern cosmology (the "Hubble Tension"). DFCM provides a value that aligns with local measurements.</dd>
                <dt>&Lambda;CDM (Lambda-CDM)</dt>
                <dd>The standard model of cosmology. It assumes the Universe is made of normal matter (baryons), "Cold Dark Matter" (CDM), and a cosmological constant "Lambda" (&Lambda;) that represents dark energy and drives cosmic acceleration. Despite its successes, it faces several unresolved tensions with observations.</dd>
                <dt>Baryon Acoustic Oscillations (BAO)</dt>
                <dd>Sound waves that propagated through the early Universe when it was a hot, dense plasma. These waves left a characteristic imprint on the distribution of matter, creating a "standard ruler" that cosmologists use to measure cosmic distances and the expansion history of the Universe.</dd>
                <dt>Big Bang Nucleosynthesis (BBN)</dt>
                <dd>The period in the early Universe (a few minutes after the Big Bang) when the first light elements (Hydrogen, Helium, Lithium, etc.) were formed through nuclear fusion. The predicted abundances of these elements must match observations for a cosmological model to be valid.</dd>
                <dt>Cosmic Microwave Background (CMB)</dt>
                <dd>The faint afterglow of the Big Bang, a nearly uniform bath of microwave radiation that fills the entire sky. It was emitted when the Universe became transparent (around 380,000 years old) and provides a snapshot of the early cosmos, containing crucial information about its composition and evolution.</dd>
                <dt>Chi-Squared (Chi<sup>2</sup>)</dt>
                <dd>A statistical measure used to assess how well a theoretical model's predictions fit observed data. A lower value of Chi<sup>2</sup> per degree of freedom (dof) indicates a better agreement between the model and the observations. DFCM significantly reduces this value compared to &Lambda;CDM.</dd>
                <dt>Dark Matter</dt>
                <dd>A mysterious form of matter that does not interact with light or other electromagnetic radiation, making it invisible to telescopes. Its presence is inferred from its gravitational effects on visible matter, such as the rotation of galaxies and the clustering of galaxy clusters. In DFCM, it has a novel coupling with baryons.</dd>
                <dt>Dark Energy</dt>
                <dd>A hypothetical form of energy that is thought to be responsible for the observed accelerating expansion of the Universe. In &Lambda;CDM, it is represented by the cosmological constant (&Lambda;). In DFCM, its effect is intrinsically linked to the evolving fractal dimension of spacetime through a dynamic equation of state.</dd>
                <dt>Fractal Dimension (φ(z))</dt>
                <dd>A mathematical concept that quantifies the complexity of an object or space. Unlike simple integer dimensions (like 1D for a line, 2D for a surface, 3D for a volume), a fractal dimension can be a non-integer, describing irregular and self-similar shapes. In DFCM, this property applies to spacetime itself, and it dynamically evolves with redshift.</dd>
                <dt>Friedmann Equations</dt>
                <dd>A set of fundamental equations in physical cosmology that describe the expansion of space in homogeneous and isotropic models of the Universe. In DFCM, these equations are modified to include the evolving fractal dimension, which fundamentally changes how we describe cosmic expansion.</dd>
                <dt>Luminosity Distance (D<sub>L</sub>(z))</dt>
                <dd>A measure of distance used in astronomy that relates the intrinsic brightness of an object to its observed apparent brightness. It is crucial for understanding the expansion history of the Universe, particularly through observations of Type Ia Supernovae.</dd>
                <dt>Matter Power Spectrum (P(k,z))</dt>
                <dd>A statistical tool in cosmology that describes the distribution of matter in the Universe across different scales (represented by wave number k) and at different cosmic times (redshift z). It reveals how matter clusters and forms structures like galaxies and galaxy clusters.</dd>
                <dt>Microwave Background &mu;-Distortions</dt>
                <dd>Tiny deviations from the perfect blackbody spectrum of the Cosmic Microwave Background (CMB). These distortions can be generated by energy injections into the early Universe after recombination. Detecting them would provide unique insights into early cosmic processes not observable through CMB anisotropies alone. DFCM predicts a specific amplitude for these distortions.</dd>
                <dt>Scalar Field</dt>
                <dd>A field that assigns a scalar value (a single number) to every point in space and time. In physics, scalar fields are used to describe various phenomena, such as temperature distributions or the Higgs field. In DFCM, a scalar field is theorized to emerge from fractal metric fluctuations and drive the evolution of the spacetime dimension φ(z).</dd>
                <dt>SH0ES (Supernovae H0 for the Equation of State)</dt>
                <dd>An astronomical collaboration that uses observations of Type Ia Supernovae to measure the local expansion rate of the Universe, providing one of the most precise measurements of the Hubble Constant (H<sub>0</sub>). DFCM's H<sub>0</sub> prediction aligns closely with SH0ES measurements.</dd>
                <dt>Sound Horizon (r<sub>s</sub>)</dt>
                <dd>The maximum distance sound waves could travel in the early Universe before recombination. It acts as a "standard ruler" in cosmology, allowing scientists to measure distances and infer the Universe's expansion history from features in the Cosmic Microwave Background (CMB) and Baryon Acoustic Oscillations (BAO).</dd>
                <dt>Type Ia Supernovae (SNIa)</dt>
                <dd>A specific type of supernova that results from the complete destruction of a white dwarf star in a binary system. Because they have a consistent peak luminosity, they are often referred to as "standard candles" and are used to measure vast cosmic distances and infer the expansion history of the Universe.</dd>
            </dl>
        </div>

        <div id="ai_assistant" class="page">
            <section class="hero">
                <h1>DFCM AI Assistant</h1>
                <p>Ask our AI specialized in cosmology to understand the subtleties of the Dynamic Fractal Cosmological Model.</p>
            </section>

            <div class="chat-container">
                <div class="chat-header">
                    <i class="fas fa-robot"></i>
                    <h2>DFCM Cosmology Assistant</h2>
                </div>

                <div class="chat-messages" id="chat-messages">
                    <div class="message ai-message">
                        Hello! I am an AI assistant trained on the Dynamic Fractal Cosmology Model. How can I help you today? Ask me about "φ(z)", "Hubble tension", or "BBN".
                    </div>
                </div>

                <div class="chat-input">
                    <input type="text" id="user-input" placeholder="Ask your question about cosmology..." autocomplete="off">
                    <button id="send-btn">
                        <i class="fas fa-paper-plane"></i> Send
                    </button>
                </div>

                <div class="status-indicator">
                    <div class="status-dot connected" id="status-dot"></div>
                    <span id="status-text">Connected & Ready</span>
                </div>
            </div>
        </div>

        <footer>
            <div class="footer-content">
                <div class="social-links">
                    <a href="https://phi1618.space/github" target="_blank" title="GitHub Repository"><i class="fab fa-github"></i></a>
                    <a href="https://phi1618.space/orcid" target="_blank" title="ORCID Profile"><i class="fab fa-orcid"></i></a>
                    <a href="https://phi1618.space/x" target="_blank" title="X (Twitter)"><i class="fa-brands fa-x-twitter"></i></a>
                    <a href="https://phi1618.space/zenedo" class="social-link" title="Zenodo" target="_blank"><i class="ai ai-zenodo"></i></a>
                    <a href="mailto:herbinsylvain@protonmail.com" class="social-link" title="Email" target="_blank">
                <i class="fas fa-envelope"></i>
            </a>
                </div>

                <a href="https://doi.org/10.5281/zenodo.15973540"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.15973540.svg" alt="DOI"></a>

                <p>The Dynamic Fractal Cosmological Model (DFCM) &copy; 2025 - All rights reserved</p>
                <p>A new paradigm to understand the universe</p>

                <span class="author-name">Sylvain Herbin |  ORCID: 0009-0001-3390-5012</span>
                <p>herbinsylvain@protonmail.com</p>
            </div>
        </footer>
    </div>

    <script>
        // Create dynamic stars
        function createStars() {
            const starsContainer = document.getElementById('stars');
            const starsCount = 300;

            for (let i = 0; i < starsCount; i++) {
                const star = document.createElement('div');
                star.classList.add('star');
                const size = Math.random() * 4;
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                star.style.left = `${Math.random() * 100}%`;
                star.style.top = `${Math.random() * 100}%`;
                const duration = 2 + Math.random() * 6;
                const delay = Math.random() * 5;
                star.style.setProperty('--duration', `${duration}s`);
                star.style.setProperty('--delay', `${delay}s`);
                star.style.background = Math.random() > 0.9 ? 'linear-gradient(45deg, #ff5555, #ffaaaa)' : 'white';
                star.style.boxShadow = Math.random() > 0.8 ? '0 0 10px rgba(255, 100, 100, 0.5)' : 'none';
                starsContainer.appendChild(star);
            }
        }

        // Navigate between pages
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            document.querySelectorAll('nav a').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('onclick') === `showPage('${pageId}')`) {
                    link.classList.add('active');
                }
            });
            window.scrollTo(0, 0);
        }

        // --- Chatbot Functions (Moved outside window.onload for global access) ---
        async function sendMessage() {
            const userInput = document.getElementById('user-input');
            const message = userInput ? userInput.value.trim() : '';
            const sendBtn = document.getElementById('send-btn');
            const statusDot = document.getElementById('status-dot');
            const statusText = document.getElementById('status-text');

            if (message) {
                addMessage(message, 'user');
                if (userInput) userInput.value = '';
                if (sendBtn) sendBtn.disabled = true;
                if (userInput) userInput.disabled = true;
                if (statusDot) {
                    statusDot.classList.remove('connected');
                    statusDot.style.backgroundColor = 'var(--warning)';
                }
                if (statusText) statusText.textContent = 'Processing...';

                const typingMessageDiv = addMessage('<div class="message-typing"><div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div></div>', 'ai', true);

                try {
                    // Call Vercel Function
                    const response = await fetch('https://dfcm-ai-api.vercel.app/api/chatbot', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ message })
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        console.error('Vercel Function error:', errorData);
                        throw new Error(errorData.error || 'Failed to get AI response.');
                    }

                    const data = await response.json();
                    const aiResponse = data.reply;

                    if (typingMessageDiv) typingMessageDiv.remove();
                    addMessage(aiResponse, 'ai');

                } catch (error) {
                    console.error('Failed to send message to AI:', error);
                    if (typingMessageDiv) typingMessageDiv.remove();
                    // Fallback: Google Custom Search link
                    const searchQuery = encodeURIComponent(message + ' site:arxiv.org | site:*.edu');
                    addMessage(`Sorry, an error occurred. Try another question or check search results: <a href="https://www.google.com/search?q=${searchQuery}" target="_blank">View results</a>`, 'ai');
                } finally {
                    if (sendBtn) sendBtn.disabled = false;
                    if (userInput) userInput.disabled = false;
                    if (userInput) userInput.focus();
                    if (statusDot) {
                        statusDot.classList.add('connected');
                        statusDot.style.backgroundColor = 'var(--success)';
                    }
                    if (statusText) statusText.textContent = 'Connected & Ready';
                    MathJax.typeset(); // Refresh MathJax for equations
                }
            }
        }

        function addMessage(text, sender, isHtml = false) {
            const chatMessages = document.getElementById('chat-messages');
            if (!chatMessages) {
                console.error("Chat messages container not found.");
                return null;
            }
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('message');
            messageDiv.classList.add(sender + '-message');
            if (isHtml) {
                messageDiv.innerHTML = text;
            } else {
                messageDiv.textContent = text;
            }
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            return messageDiv;
        }
        // --- End Chatbot Functions ---

        // FRISE COSMIQUE - CODE JAVASCRIPT
        // Configuration
        const config = {
            epochs: [
                { name: "BBN", z: 1e9, phi: 2.970, description: "Dense fractal primordial universe" },
                { name: "CMB", z: 1100, phi: 2.618, description: "Cosmic Microwave Background emission" },
                { name: "Galaxies", z: 10, phi: 2.0, description: "Formation of the first galaxies" },
                { name: "Present", z: 0, phi: 1.618, description: "Harmonious present era" }
            ],
            particleCount: 300,
            maxParticleSize: 6
        };

        // Éléments DOM
        const canvas = document.getElementById('cosmicCanvas');
        const ctx = canvas ? canvas.getContext('2d') : null; // Check if canvas exists
        const timeSlider = document.getElementById('timeSlider');
        const timelineProgress = document.getElementById('timelineProgress');
        const phiValue = document.querySelector('.phi-value');
        const epochDescription = document.querySelector('.epoch-description');
        const playBtn = document.getElementById('playBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const resetBtn = document.getElementById('resetBtn');

        // Variables d'état
        let currentTime = 0;
        let animationId = null;
        let particles = [];
        
        // Initialisation du canvas
        function initCanvas() {
            if (!canvas || !ctx) return; // Exit if canvas or context not found
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            createParticles();
            drawVisualization();
        }
        
        // Création des particules
        function createParticles() {
            particles = [];
            for (let i = 0; i < config.particleCount; i++) {
                particles.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    size: Math.random() * config.maxParticleSize + 1,
                    speedX: (Math.random() - 0.5) * 0.5,
                    speedY: (Math.random() - 0.5) * 0.5,
                    color: getRandomParticleColor(),
                    originalSize: Math.random() * config.maxParticleSize + 1
                });
            }
        }
        
        function getRandomParticleColor() {
            const colors = [
                getComputedStyle(document.documentElement).getPropertyValue('--accent').trim(),
                getComputedStyle(document.documentElement).getPropertyValue('--accent-light').trim(),
                getComputedStyle(document.documentElement).getPropertyValue('--success').trim(),
                getComputedStyle(document.documentElement).getPropertyValue('--warning').trim()
            ];
            return colors[Math.floor(Math.random() * colors.length)];
        }
        
        // Calcul de φ(z) en fonction du temps
        function calculatePhi(timePercent) {
            if (timePercent < 0.2) {
                return interpolate(timePercent, 0, 0.2, 2.970, 2.618);
            } else if (timePercent < 0.6) {
                return interpolate(timePercent, 0.2, 0.6, 2.618, 2.0);
            } else {
                return interpolate(timePercent, 0.6, 1.0, 2.0, 1.618);
            }
        }
        
        function interpolate(value, inMin, inMax, outMin, outMax) {
            return outMin + (outMax - outMin) * ((value - inMin) / (inMax - inMin));
        }
        
        // Dessin de la visualisation
        function drawVisualization() {
            if (!ctx) return; // Exit if context not found
            const timePercent = currentTime / 100;
            const phi = calculatePhi(timePercent);
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawBackground(timePercent);
            drawFractalPatterns(timePercent, phi);
            updateInfoPanel(phi, timePercent);
        }
        
        function drawBackground(timePercent) {
            if (!ctx) return;
            const gradient = ctx.createRadialGradient(
                canvas.width/2, canvas.height/2, 0,
                canvas.width/2, canvas.height/2, Math.max(canvas.width, canvas.height)/2
            );
            
            const primaryColor = getComputedStyle(document.documentElement).getPropertyValue('--primary').trim();
            const accentColor = getComputedStyle(document.documentElement).getPropertyValue('--accent').trim();
            const accentLightColor = getComputedStyle(document.documentElement).getPropertyValue('--accent-light').trim();
            
            if (timePercent < 0.3) {
                gradient.addColorStop(0, 'rgba(255, 100, 150, 0.1)');
                gradient.addColorStop(0.5, 'rgba(150, 50, 100, 0.05)');
                gradient.addColorStop(1, 'rgba(50, 10, 30, 0.01)');
            } else if (timePercent < 0.7) {
                gradient.addColorStop(0, `rgba(${hexToRgb(accentColor)}, 0.15)`);
                gradient.addColorStop(0.5, `rgba(${hexToRgb(accentLightColor)}, 0.08)`);
                gradient.addColorStop(1, `rgba(${hexToRgb(primaryColor)}, 0.02)`);
            } else {
                const successColor = getComputedStyle(document.documentElement).getPropertyValue('--success').trim();
                gradient.addColorStop(0, `rgba(${hexToRgb(successColor)}, 0.1)`);
                gradient.addColorStop(0.5, `rgba(${hexToRgb(accentColor)}, 0.05)`);
                gradient.addColorStop(1, `rgba(${hexToRgb(primaryColor)}, 0.01)`);
            }
            
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }
        
        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? 
                `${parseInt(result[1], 16)}, ${parseInt(result[2], 16)}, ${parseInt(result[3], 16)}` 
                : '106, 90, 249';
        }
        
        function drawFractalPatterns(timePercent, phi) {
            if (!ctx) return;
            drawParticles(timePercent, phi);
            
            if (timePercent < 0.3) {
                drawFractalClusters();
            } else if (timePercent > 0.8) {
                drawGoldenSpiral();
            }
        }
        
        function drawParticles(timePercent, phi) {
            if (!ctx) return;
            const fractalFactor = 1 - (phi - 1.618) / (2.970 - 1.618);
            
            particles.forEach(particle => {
                particle.x += particle.speedX;
                particle.y += particle.speedY;
                
                if (particle.x < 0) particle.x = canvas.width;
                if (particle.x > canvas.width) particle.x = 0;
                if (particle.y < 0) particle.y = canvas.height;
                if (particle.y > canvas.height) particle.y = 0;
                
                const sizeFactor = timePercent < 0.3 ? 1.5 : 1;
                const currentSize = particle.originalSize * sizeFactor * fractalFactor;
                
                ctx.beginPath();
                ctx.arc(particle.x, particle.y, currentSize, 0, Math.PI * 2);
                ctx.fillStyle = particle.color;
                ctx.fill();
                
                if (timePercent < 0.4) {
                    particles.forEach(other => {
                        const dx = particle.x - other.x;
                        const dy = particle.y - other.y;
                        const distance = Math.sqrt(dx*dx + dy*dy);
                        
                        if (distance < 80) {
                            ctx.beginPath();
                            ctx.moveTo(particle.x, particle.y);
                            ctx.lineTo(other.x, other.y);
                            ctx.strokeStyle = `rgba(106, 90, 249, ${0.3 * (1 - distance/80)})`;
                            ctx.lineWidth = 0.5;
                            ctx.stroke();
                        }
                    });
                }
            });
        }
        
        function drawFractalClusters() {
            if (!ctx) return;
            for (let i = 0; i < 15; i++) {
                const x = Math.random() * canvas.width;
                const y = Math.random() * canvas.height;
                const size = 30 + Math.random() * 70;
                const branchCount = 5 + Math.floor(Math.random() * 8);
                
                ctx.save();
                ctx.translate(x, y);
                
                for (let j = 0; j < branchCount; j++) {
                    ctx.rotate((Math.PI * 2) / branchCount);
                    drawFractalBranch(0, 0, size, 0, 5);
                }
                
                ctx.restore();
            }
        }
        
        function drawFractalBranch(x, y, length, angle, depth) {
            if (depth === 0 || !ctx) return;
            
            const endX = x + length * Math.cos(angle);
            const endY = y + length * Math.sin(angle);
            
            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.lineTo(endX, endY);
            ctx.strokeStyle = `rgba(255, 121, 198, ${0.4 - depth * 0.07})`;
            ctx.lineWidth = depth * 0.7;
            ctx.stroke();
            
            const subBranches = 2 + Math.floor(Math.random() * 3);
            for (let i = 0; i < subBranches; i++) {
                const newAngle = angle - Math.PI/4 + Math.random() * Math.PI/2;
                const newLength = length * (0.5 + Math.random() * 0.3);
                drawFractalBranch(endX, endY, newLength, newAngle, depth - 1);
            }
        }
        
        function drawGoldenSpiral() {
            if (!ctx) return;
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const maxRadius = Math.min(canvas.width, canvas.height) * 0.4;
            let radius = 1;
            let angle = 0;
            
            ctx.beginPath();
            ctx.moveTo(centerX, centerY);
            
            while (radius < maxRadius) {
                angle += 0.1;
                radius = Math.exp(angle * 0.306);
                
                const x = centerX + Math.cos(angle) * radius;
                const y = centerY + Math.sin(angle) * radius;
                
                ctx.lineTo(x, y);
            }
            
            const goldenColor = getComputedStyle(document.documentElement).getPropertyValue('--warning').trim();
            ctx.strokeStyle = `${goldenColor}cc`;
            ctx.lineWidth = 2;
            ctx.stroke();
            
            for (let i = 0; i < 100; i++) {
                angle = i * 0.2;
                radius = Math.exp(angle * 0.306);
                
                if (radius > maxRadius) break;
                
                const x = centerX + Math.cos(angle) * radius;
                const y = centerY + Math.sin(angle) * radius;
                
                ctx.beginPath();
                ctx.arc(x, y, 2, 0, Math.PI * 2);
                ctx.fillStyle = goldenColor;
                ctx.fill();
            }
        }
        
        function updateInfoPanel(phi, timePercent) {
            if (phiValue) phiValue.textContent = `φ(z) = ${phi.toFixed(3)}`;
            
            if (epochDescription) {
                if (timePercent < 0.2) {
                    epochDescription.textContent = "Dense fractal primordial universe";
                } else if (timePercent < 0.4) {
                    epochDescription.textContent = "Cosmic Microwave Background emission";
                } else if (timePercent < 0.7) {
                    epochDescription.textContent = "Galaxy formation and structures";
                } else {
                    epochDescription.textContent = "Harmonious present era dominated by the golden ratio";
                }
            }
        }
        
        // Gestion des événements
        if (timeSlider) { // Check before adding listener
            timeSlider.addEventListener('input', () => {
                currentTime = parseInt(timeSlider.value);
                if (timelineProgress) timelineProgress.style.width = `${currentTime}%`;
                drawVisualization();
            });
        }
        
        if (playBtn) { // Check before adding listener
            playBtn.addEventListener('click', () => {
                if (animationId) return;
                
                function animate() {
                    currentTime += 0.5;
                    if (currentTime > 100) currentTime = 0;
                    
                    if (timeSlider) timeSlider.value = currentTime;
                    if (timelineProgress) timelineProgress.style.width = `${currentTime}%`;
                    drawVisualization();
                    
                    animationId = requestAnimationFrame(animate);
                }
                
                animate();
            });
        }
        
        if (pauseBtn) { // Check before adding listener
            pauseBtn.addEventListener('click', () => {
                if (animationId) {
                    cancelAnimationFrame(animationId);
                    animationId = null;
                }
            });
        }
        
        if (resetBtn) { // Check before adding listener
            resetBtn.addEventListener('click', () => {
                if (animationId) {
                    cancelAnimationFrame(animationId);
                    animationId = null;
                }
                currentTime = 0;
                if (timeSlider) timeSlider.value = currentTime;
                if (timelineProgress) timelineProgress.style.width = `${currentTime}%`;
                drawVisualization();
            });
        }
        
        // Initialize
        window.onload = function() {
            createStars();
            
            // Event listener for user input (Enter key)
            const userInputElement = document.getElementById('user-input');
            if (userInputElement) { // Ensure element exists before adding listener
                userInputElement.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendMessage();
                    }
                });
            }

            // Event listener for the Send button
            const sendButtonElement = document.getElementById('send-btn');
            if (sendButtonElement) { // Ensure element exists before adding listener
                sendButtonElement.addEventListener('click', sendMessage);
            }

            // Focus on input when AI Assistant page is shown
            const aiAssistantLink = document.querySelector('nav a[onclick="showPage(\'ai_assistant\')"]');
            if (aiAssistantLink) {
                aiAssistantLink.addEventListener('click', function() {
                    setTimeout(() => {
                        const currentUserInput = document.getElementById('user-input');
                        if (currentUserInput) currentUserInput.focus();
                    }, 500);
                });
            }

            // Initialiser la frise cosmique
            initCanvas();
            window.addEventListener('resize', initCanvas);
            MathJax.typeset();
        };
    </script>
</body>
</html>
